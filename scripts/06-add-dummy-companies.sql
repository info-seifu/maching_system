-- 既存のダミー企業を削除（クリーンアップ）
DELETE FROM public.matches WHERE position_id IN (
    SELECT id FROM public.positions WHERE company_id IN (
        SELECT id FROM public.companies WHERE name LIKE '%株式会社' OR name LIKE '%Corporation'
    )
);
DELETE FROM public.positions WHERE company_id IN (
    SELECT id FROM public.companies WHERE name LIKE '%株式会社' OR name LIKE '%Corporation'
);
DELETE FROM public.companies WHERE name LIKE '%株式会社' OR name LIKE '%Corporation';

-- 多様な業界のダミー企業を追加
INSERT INTO public.companies (id, user_id, name, industry, location, contact_email) VALUES
-- IT・テクノロジー企業
('660e8400-e29b-41d4-a716-446655440001', '550e8400-e29b-41d4-a716-446655440003', 'テックイノベーション株式会社', 'IT', '東京都渋谷区', 'hr@tech-innovation.co.jp'),
('660e8400-e29b-41d4-a716-446655440002', '550e8400-e29b-41d4-a716-446655440003', 'デジタルソリューションズ', 'テクノロジー', '東京都新宿区', 'recruit@digital-solutions.com'),
('660e8400-e29b-41d4-a716-446655440003', '550e8400-e29b-41d4-a716-446655440003', 'クラウドワークス株式会社', 'IT', '東京都港区', 'jobs@cloudworks.jp'),
('660e8400-e29b-41d4-a716-446655440004', '550e8400-e29b-41d4-a716-446655440003', 'AIテクノロジーズ', '人工知能', '東京都品川区', 'careers@ai-tech.co.jp'),
('660e8400-e29b-41d4-a716-446655440005', '550e8400-e29b-41d4-a716-446655440003', 'サイバーセキュリティ株式会社', 'セキュリティ', '東京都千代田区', 'hr@cybersec.jp'),

-- ゲーム・エンターテイメント企業
('660e8400-e29b-41d4-a716-446655440006', '550e8400-e29b-41d4-a716-446655440003', 'ゲームスタジオ東京', 'ゲーム開発', '東京都中野区', 'recruit@gamestudio-tokyo.com'),
('660e8400-e29b-41d4-a716-446655440007', '550e8400-e29b-41d4-a716-446655440003', 'エンターテイメントラボ', 'エンターテイメント', '大阪府大阪市', 'jobs@ent-lab.co.jp'),

-- 金融・フィンテック企業
('660e8400-e29b-41d4-a716-446655440008', '550e8400-e29b-41d4-a716-446655440003', 'フィンテックイノベーション', '金融', '東京都丸の内', 'careers@fintech-innovation.jp'),
('660e8400-e29b-41d4-a716-446655440009', '550e8400-e29b-41d4-a716-446655440003', 'デジタルバンキング株式会社', '金融', '東京都大手町', 'hr@digital-banking.co.jp'),

-- ヘルスケア・バイオテック企業
('660e8400-e29b-41d4-a716-446655440010', '550e8400-e29b-41d4-a716-446655440003', 'メディカルテック株式会社', 'ヘルスケア', '神奈川県横浜市', 'recruit@medical-tech.jp'),
('660e8400-e29b-41d4-a716-446655440011', '550e8400-e29b-41d4-a716-446655440003', 'バイオイノベーション', 'バイオテクノロジー', '大阪府吹田市', 'jobs@bio-innovation.co.jp'),

-- 教育・EdTech企業
('660e8400-e29b-41d4-a716-446655440012', '550e8400-e29b-41d4-a716-446655440003', 'エデュテック株式会社', '教育', '東京都文京区', 'careers@edutech.jp'),
('660e8400-e29b-41d4-a716-446655440013', '550e8400-e29b-41d4-a716-446655440003', 'ラーニングプラットフォーム', '教育', '京都府京都市', 'hr@learning-platform.co.jp'),

-- 製造業・IoT企業
('660e8400-e29b-41d4-a716-446655440014', '550e8400-e29b-41d4-a716-446655440003', 'スマートファクトリー株式会社', '製造業', '愛知県名古屋市', 'recruit@smart-factory.jp'),
('660e8400-e29b-41d4-a716-446655440015', '550e8400-e29b-41d4-a716-446655440003', 'IoTソリューションズ', 'IoT', '福岡県福岡市', 'jobs@iot-solutions.co.jp'),

-- コンサルティング企業
('660e8400-e29b-41d4-a716-446655440016', '550e8400-e29b-41d4-a716-446655440003', 'デジタルコンサルティング', 'コンサルティング', '東京都六本木', 'careers@digital-consulting.jp'),
('660e8400-e29b-41d4-a716-446655440017', '550e8400-e29b-41d4-a716-446655440003', 'ビジネスイノベーション株式会社', 'コンサルティング', '東京都虎ノ門', 'hr@business-innovation.co.jp'),

-- メディア・広告企業
('660e8400-e29b-41d4-a716-446655440018', '550e8400-e29b-41d4-a716-446655440003', 'デジタルメディア株式会社', 'メディア', '東京都恵比寿', 'recruit@digital-media.jp'),
('660e8400-e29b-41d4-a716-446655440019', '550e8400-e29b-41d4-a716-446655440003', 'アドテクノロジーズ', '広告', '東京都表参道', 'jobs@adtech.co.jp'),

-- スタートアップ・ベンチャー企業
('660e8400-e29b-41d4-a716-446655440020', '550e8400-e29b-41d4-a716-446655440003', 'ネクストジェネレーション', 'スタートアップ', '東京都目黒区', 'careers@nextgen.jp')
ON CONFLICT (id) DO UPDATE SET
    name = EXCLUDED.name,
    industry = EXCLUDED.industry,
    location = EXCLUDED.location,
    contact_email = EXCLUDED.contact_email,
    updated_at = NOW();

-- 各企業の募集ポジションを追加
INSERT INTO public.positions (id, company_id, title, description, required_expertise, start_date, end_date, status) VALUES
-- テックイノベーション株式会社
('880e8400-e29b-41d4-a716-446655440001', '660e8400-e29b-41d4-a716-446655440001', 'フロントエンドエンジニア', 'React/Next.jsを使用したWebアプリケーション開発', ARRAY['Webフロントエンド', 'UI/UXデザイン'], '2025-04-01', '2025-12-31', 'OPEN'),
('880e8400-e29b-41d4-a716-446655440002', '660e8400-e29b-41d4-a716-446655440001', 'バックエンドエンジニア', 'Node.js/Pythonを使用したAPI開発', ARRAY['バックエンド開発', 'データベース設計'], '2025-04-01', '2025-12-31', 'OPEN'),

-- デジタルソリューションズ
('880e8400-e29b-41d4-a716-446655440003', '660e8400-e29b-41d4-a716-446655440002', 'データサイエンティスト', '機械学習を活用したデータ分析業務', ARRAY['データサイエンス', '機械学習'], '2025-05-01', '2025-12-31', 'OPEN'),
('880e8400-e29b-41d4-a716-446655440004', '660e8400-e29b-41d4-a716-446655440002', 'クラウドエンジニア', 'AWS/Azureを使用したインフラ構築', ARRAY['クラウドインフラ', 'DevOps'], '2025-05-01', '2025-12-31', 'OPEN'),

-- クラウドワークス株式会社
('880e8400-e29b-41d4-a716-446655440005', '660e8400-e29b-41d4-a716-446655440003', 'UI/UXデザイナー', 'ユーザー体験を重視したデザイン設計', ARRAY['UI/UXデザイン'], '2025-04-15', '2025-12-31', 'OPEN'),
('880e8400-e29b-41d4-a716-446655440006', '660e8400-e29b-41d4-a716-446655440003', 'モバイルアプリエンジニア', 'React Native/Flutterを使用したアプリ開発', ARRAY['モバイルアプリ開発'], '2025-04-15', '2025-12-31', 'OPEN'),

-- AIテクノロジーズ
('880e8400-e29b-41d4-a716-446655440007', '660e8400-e29b-41d4-a716-446655440004', 'AIエンジニア', '機械学習モデルの開発と実装', ARRAY['人工知能', '機械学習'], '2025-06-01', '2025-12-31', 'OPEN'),
('880e8400-e29b-41d4-a716-446655440008', '660e8400-e29b-41d4-a716-446655440004', 'データエンジニア', 'ビッグデータ処理基盤の構築', ARRAY['データサイエンス', 'バックエンド開発'], '2025-06-01', '2025-12-31', 'OPEN'),

-- サイバーセキュリティ株式会社
('880e8400-e29b-41d4-a716-446655440009', '660e8400-e29b-41d4-a716-446655440005', 'セキュリティエンジニア', 'サイバーセキュリティ対策の設計・実装', ARRAY['セキュリティ', 'バックエンド開発'], '2025-05-15', '2025-12-31', 'OPEN'),

-- ゲームスタジオ東京
('880e8400-e29b-41d4-a716-446655440010', '660e8400-e29b-41d4-a716-446655440006', 'ゲームプログラマー', 'Unity/Unreal Engineを使用したゲーム開発', ARRAY['ゲーム開発'], '2025-04-01', '2025-12-31', 'OPEN'),
('880e8400-e29b-41d4-a716-446655440011', '660e8400-e29b-41d4-a716-446655440006', 'ゲームデザイナー', 'ゲームのUI/UXデザイン', ARRAY['UI/UXデザイン', 'ゲーム開発'], '2025-04-01', '2025-12-31', 'OPEN'),

-- エンターテイメントラボ
('880e8400-e29b-41d4-a716-446655440012', '660e8400-e29b-41d4-a716-446655440007', 'VR/ARエンジニア', 'VR/AR技術を活用したコンテンツ開発', ARRAY['ゲーム開発', '人工知能'], '2025-07-01', '2025-12-31', 'OPEN'),

-- フィンテックイノベーション
('880e8400-e29b-41d4-a716-446655440013', '660e8400-e29b-41d4-a716-446655440008', 'フィンテックエンジニア', '金融システムの開発・運用', ARRAY['バックエンド開発', 'セキュリティ'], '2025-05-01', '2025-12-31', 'OPEN'),

-- デジタルバンキング株式会社
('880e8400-e29b-41d4-a716-446655440014', '660e8400-e29b-41d4-a716-446655440009', 'ブロックチェーンエンジニア', 'ブロックチェーン技術を活用したシステム開発', ARRAY['バックエンド開発', 'セキュリティ'], '2025-06-15', '2025-12-31', 'OPEN'),

-- メディカルテック株式会社
('880e8400-e29b-41d4-a716-446655440015', '660e8400-e29b-41d4-a716-446655440010', 'ヘルスケアエンジニア', '医療システムの開発', ARRAY['バックエンド開発', 'データサイエンス'], '2025-04-01', '2025-12-31', 'OPEN'),

-- バイオイノベーション
('880e8400-e29b-41d4-a716-446655440016', '660e8400-e29b-41d4-a716-446655440011', 'バイオインフォマティクスエンジニア', '生物学的データの解析システム開発', ARRAY['データサイエンス', '機械学習'], '2025-07-01', '2025-12-31', 'OPEN'),

-- エデュテック株式会社
('880e8400-e29b-41d4-a716-446655440017', '660e8400-e29b-41d4-a716-446655440012', 'EdTechエンジニア', '教育プラットフォームの開発', ARRAY['Webフロントエンド', 'バックエンド開発'], '2025-04-01', '2025-12-31', 'OPEN'),

-- ラーニングプラットフォーム
('880e8400-e29b-41d4-a716-446655440018', '660e8400-e29b-41d4-a716-446655440013', 'eラーニングシステムエンジニア', 'オンライン学習システムの開発', ARRAY['Webフロントエンド', 'UI/UXデザイン'], '2025-05-01', '2025-12-31', 'OPEN'),

-- スマートファクトリー株式会社
('880e8400-e29b-41d4-a716-446655440019', '660e8400-e29b-41d4-a716-446655440014', 'IoTエンジニア', '製造業向けIoTシステムの開発', ARRAY['バックエンド開発', 'クラウドインフラ'], '2025-06-01', '2025-12-31', 'OPEN'),

-- IoTソリューションズ
('880e8400-e29b-41d4-a716-446655440020', '660e8400-e29b-41d4-a716-446655440015', 'エンベデッドエンジニア', '組み込みシステムの開発', ARRAY['バックエンド開発'], '2025-07-01', '2025-12-31', 'OPEN'),

-- デジタルコンサルティング
('880e8400-e29b-41d4-a716-446655440021', '660e8400-e29b-41d4-a716-446655440016', 'ITコンサルタント', 'デジタル変革のコンサルティング', ARRAY['Webフロントエンド', 'バックエンド開発'], '2025-04-01', '2025-12-31', 'OPEN'),

-- ビジネスイノベーション株式会社
('880e8400-e29b-41d4-a716-446655440022', '660e8400-e29b-41d4-a716-446655440017', 'ビジネスアナリスト', 'データ分析によるビジネス改善提案', ARRAY['データサイエンス'], '2025-05-01', '2025-12-31', 'OPEN'),

-- デジタルメディア株式会社
('880e8400-e29b-41d4-a716-446655440023', '660e8400-e29b-41d4-a716-446655440018', 'メディアエンジニア', 'デジタルメディアプラットフォームの開発', ARRAY['Webフロントエンド', 'バックエンド開発'], '2025-04-15', '2025-12-31', 'OPEN'),

-- アドテクノロジーズ
('880e8400-e29b-41d4-a716-446655440024', '660e8400-e29b-41d4-a716-446655440019', 'アドテクエンジニア', '広告配信システムの開発・運用', ARRAY['バックエンド開発', 'データサイエンス'], '2025-06-01', '2025-12-31', 'OPEN'),

-- ネクストジェネレーション
('880e8400-e29b-41d4-a716-446655440025', '660e8400-e29b-41d4-a716-446655440020', 'フルスタックエンジニア', 'スタートアップでの幅広い技術領域での開発', ARRAY['Webフロントエンド', 'バックエンド開発', 'UI/UXデザイン'], '2025-04-01', '2025-12-31', 'OPEN')
ON CONFLICT (id) DO UPDATE SET
    title = EXCLUDED.title,
    description = EXCLUDED.description,
    required_expertise = EXCLUDED.required_expertise,
    start_date = EXCLUDED.start_date,
    end_date = EXCLUDED.end_date,
    status = EXCLUDED.status,
    updated_at = NOW();

-- サンプルマッチングデータを追加
INSERT INTO public.matches (student_id, position_id, match_score, status) VALUES
-- 既存の学生とのマッチング
('770e8400-e29b-41d4-a716-446655440001', '880e8400-e29b-41d4-a716-446655440001', 95, 'PROPOSED'), -- 山田太郎 × フロントエンドエンジニア
('770e8400-e29b-41d4-a716-446655440001', '880e8400-e29b-41d4-a716-446655440005', 88, 'PROPOSED'), -- 山田太郎 × UI/UXデザイナー
('770e8400-e29b-41d4-a716-446655440002', '880e8400-e29b-41d4-a716-446655440003', 92, 'ACCEPTED'), -- 佐藤花子 × データサイエンティスト
('770e8400-e29b-41d4-a716-446655440002', '880e8400-e29b-41d4-a716-446655440008', 89, 'PROPOSED'), -- 佐藤花子 × データエンジニア
('770e8400-e29b-41d4-a716-446655440003', '880e8400-e29b-41d4-a716-446655440002', 91, 'PROPOSED'), -- 鈴木一郎 × バックエンドエンジニア
('770e8400-e29b-41d4-a716-446655440004', '880e8400-e29b-41d4-a716-446655440011', 94, 'ACCEPTED'), -- 田中美咲 × ゲームデザイナー
('770e8400-e29b-41d4-a716-446655440005', '880e8400-e29b-41d4-a716-446655440007', 96, 'PROPOSED') -- 高橋健太 × AIエンジニア
ON CONFLICT (student_id, position_id) DO UPDATE SET
    match_score = EXCLUDED.match_score,
    status = EXCLUDED.status,
    updated_at = NOW();
